{% extends "commons_base.html" %}
{% load i18n staticfiles %}

{% block head_title %}{% trans "learning path"|capfirst %}: {{ lp.title }}{% endblock %}

{% block body_class %}lp_viewer paddingT60{% endblock %}
{% block body %}
{% block navbar_base %}
{% endblock %}
{% block body_base %}
<div class="container-fluid margin0 padding0">
<div class="row margin0">
  <div class="col-sm-3 col-md-3 col-lg-3" style="padding-left:0" id="list_nodes">
 
  	<div style="background: white; padding:10px 5px 0 20px; border-bottom: 1px dotted #CB4F98">
    <div class="clearfix">
    <h5 class="pull-left c-mulberry" style="width: 90%; margin-bottom:5px">{% if not is_published %}<small style="color: {{ lp.get_link_color }};">[{{ lp.get_state }}]</small>{% endif %}{{ lp.title }}</h5>
<p class="pull-right paddingT10 paddingLR5" style="width: 10%; margin-bottom:5px; ">
      <a href="/lp/{{ lp.slug }}/"><i class="fa fa-list-alt font18 c-mulberry" aria-hidden="true"></i></a>
    </p>
    </div>
    <p class="font12">{{ lp.short|safe }}</p>
    </div>
    {% if nodes %}
{% if lp.path_type == 3 %}
    {% comment %}<div id="dag"></div>{% endcomment %}
    {% comment %} SEE http://stackoverflow.com/questions/32044/how-can-i-render-a-tree-structure-recursive-using-a-django-template{% endcomment %}
   	<dl class="panel panel-col panel-white">
    <dd>
	{% for pathnode in lp.get_roots %} 
		{% with font=14 depth=1 %}
	    	{% include "_lp_subtree.html" %}
	    {% endwith %}
	{% endfor%}
	{% for pathnode in lp.get_islands %} 
		{% with font=14 depth=1 %}
	    	{% include "_lp_subtree.html" %}
	    {% endwith %}
	{% endfor%}
    </dd>
    </dl>
{% else %}
    	<dl class="panel panel-col panel-white">
        <dd>
        {% for pathnode in nodes %}
          <ul class="nodes-unlisted {% if pathnode.oer_id %} node-oer {% else %} node-text {% endif %} font14">
            <li>
            {% if pathnode == current_node %}
              <div>{% if lp.path_type == 2 %}{{ forloop.counter }}. {% endif %}{{ pathnode.label }}</div>
            {% else %}
              {% if lp.path_type == 2 %}{{ forloop.counter }}. {% endif %}<a href="/lp/{{ lp.slug }}/play/?node={{ forloop.counter0 }}" title="path node">{{ pathnode.label }}</a>
            {% endif %}
            </li>
          </ul>
        {% endfor %}
        </dd>
      </dl>
{% endif %}
	{% endif %}

</div>

<div class="col-sm-9 col-md-9 col-lg-9" style="background:white;" id="right">
  <div class="clearfix" style="margin:0 -15px; background:white; padding:8px 15px">
    <div class="pull-left" style="width:10%">{% if i_node_prev < i_node %}<a href="/lp/{{ lp.slug }}/play/?node={{ i_node_prev }}"><i class="fa fa-long-arrow-left" aria-hidden="true"></i> {% trans "prev" %}</a>{% endif %} </div>
    <div class="text-center" style="float:left; width:80%">{{ i_node|add:"1" }}/{{ nodes|length }}
    	&nbsp; {{ current_node.label }}
		&nbsp; <a href="/pathnode/{{ current_node.id }}/"><i class="fa fa-list-alt font18 c-mulberry" aria-hidden="true"></i></a></div>
    <div class="pull-right text-right" style="width:10%">{% if i_node_next > i_node %}<a href="/lp/{{ lp.slug }}/play/?node={{ i_node_next }}">{% trans "next" %} <i class="fa fa-long-arrow-right" aria-hidden="true"></i></a>{% endif %}</div>
  </div>
{% if not oer_is_un_published %}
  {% if oer.url %}
    <p class="view-url" style="padding-top:10px; border-top: 1px solid #333">URL: <a href="{{ oer.url }}" target="_blank">{{ oer.url }}</a></p>
  {% endif %}
{% endif %}
  <div class="iframe-container">
{% if oer %}
  {% if not oer_is_un_published %}
    {% if document_view %}
      {{ document_view|safe }}
    {% elif youtube %}
      {{ youtube|safe }}
    {% elif ted_talk %}
      {{ ted_talk|safe }}
    {% elif slideshare %}
      {{ slideshare|safe }}
    {% elif embed_code %}
      {{ embed_code|safe }}
    {% else %}
      <iframe id="frame" src="{{ oer_url }}" allowfullscreen></iframe>
    {% endif %}
  {% else %}
  <h2 class="text-center marginT30" style="color: {{ oer.get_link_color }};">OER {{ oer.get_state|upper }}</h2>
  {% endif %}
{% else %}
  {% if document_view %}
    {{ document_view|safe }}
  {% elif text_view %}
    {{ text_view|safe }}
  {% endif %}
{% endif %}
  </div>
  <div class="clearfix" style="margin:0 -15px; background:white; padding:8px 15px">
    <div class="pull-left">{% if i_node_prev < i_node %}<a href="/lp/{{ lp.slug }}/play/?node={{ i_node_prev }}"><i class="fa fa-long-arrow-left" aria-hidden="true"></i> {% trans "prev" %}</a>{% endif %} </div>
    <div class="pull-right">{% if i_node_next > i_node %}<a href="/lp/{{ lp.slug }}/play/?node={{ i_node_next }}">{% trans "next" %} <i class="fa fa-long-arrow-right" aria-hidden="true"></i></a>{% endif %}</div>
  </div>
</div>
</div>
</div>
{% endblock %}

{% block extra_script %}
{% if lp.path_type == 1000 %}{% include "_lp_dag.html" %}{% endif %}
{% endblock %}

{% endblock %}



