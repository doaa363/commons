{% load staticfiles dmuc %}
{% load i18n %}
{% load url from future %}
{% load menu %}
{% generate_menu %}

<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}">
    <head>
        <meta charset="utf-8" />
        <title>{% block head_title_base %}{% block head_title %}{% endblock %}{% endblock %}{% if site_name  %} | {{ site_name }}{% endif %}</title>

        {% block viewport %}
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
        {% endblock %}
        
        <link rel="shortcut icon" href="{% static "commons/img/commons.ico" %}" type="image/x-icon">
        <link rel="apple-touch-icon" href="{% static "commons/img/commons_icon.png" %}">

        {% block style_base %}
            {% comment %}<link href="{% static "pinax/css/theme.css" %}" rel="stylesheet">{% endcomment %}
            <link href="{% static "bootstrap/css/bootstrap.css" %}" rel="stylesheet">
            <link href="{% static "font-awesome/css/font-awesome.css" %}" rel="stylesheet">

            {% block plus_style %}{% endblock %}
            {% block extra_style %}{% endblock %}
        {% endblock %}

        {% block html5shim %}
            <!-- HTML5 shim, for IE6-8 support of HTML elements -->
            <!--[if lt IE 9]>
                <script src="{% static "pinax/js/html5shiv.js" %}"></script>
            <![endif]-->
        {% endblock %}

        <script src="{% static "jquery/js/jquery-2.1.4.min.js" %}"></script>

        {% block extra_head_base %}
            {% block extra_head %}{% endblock %}
        {% endblock %}
    </head>
    
    <body class="bc-demigray {% block body_class %}{% endblock %}" id="{% block body_id %}{% endblock %}">
        <div class="{% block wrapper_class %}wrapper{% endblock %}">

            {% block topbar_base %}
                <header>
                    <div class="navbar-fixed-top">
                        {% block user %} {% include "_access_bar.html" %} {% endblock user %}
                        {% block navbar_base %}
                        <div class="navbar navbar-default" >
                            <div class="container">
                            {% block topbar %}
                                <div class="navbar-header">
                                    <button class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                                        <span class="fa fa-bars"></span>
                                    </button>
                                    {% comment %}
                                       {% block site_brand %}<a class="navbar-brand" href="{% url "home" %}">{{ SITE_NAME }}</a>{% endblock %}
                                    {% endcomment %}
                                </div>
                                <div class="collapse navbar-collapse navbar-responsive-collapse">
                                {% block nav %}
                                    {% comment %}
                                        <ul class="nav navbar-nav">
                                            <li><a href="#tab_one">One</a></li>
                                            <li><a href="#tab_two">Two</a></li>
                                        </ul>
                                    {% endcomment %}
                                {% endblock nav %}
                                {% comment %}
                                    {% block account_bar %}{% include "_account_bar.html" %}{% endblock %}
                                {% endcomment %}
                                </div>
                            {% endblock topbar %}
                            </div>
                        </div>
                        {% endblock navbar_base %}
                    </div>
                </header>
                {% block login_model %}{% include "_login_model.html" %}{% endblock %}
            {% endblock topbar_base %}

            {% block body_base %}
                <section id="content_body">
                    <div class="container">
                    	
                        {% comment %}{% include "_messages.html" %}{% endcomment %}
                        {% block body %}
                        {% endblock %}
                    </div>
                </section>
            {% endblock %}
        </div>

            {% block footer_base %}
               <footer class="footer-fixed">
                  <div class="container">
                      {% block footer %}{% endblock %}
                  </div>
               </footer>
            {% endblock %}

        {% block script_base %}
            <script src="{% static "js/bootstrap.min.js" %}"></script>
            <script src="{% static "pinax/js/theme.js" %}"></script>
            <script type="text/javascript" src="{% static 'autocomplete_light/autocomplete.js' %}"></script>
            <script type="text/javascript">
              $(document).ready(function() {
               	if ($('#navigation_autocomplete').length > 0) {
                  $('#navigation_autocomplete').yourlabsAutocomplete({
                    url: '{% url 'navigation_autocomplete' %}',
                    choiceSelector: 'a',
                    minimumCharacters: 3,
                    placeholder: '{% trans "Search ... (enter at least 3 characters)" %}',
                  }).input.bind('selectChoice', function(e, choice, autocomplete) {
                    document.location.href = choice.attr('href');
                  });
                }
              });
            </script>
            {% block extra_script %}{% endblock %}
        {% endblock %}

        {% block extra_body_base %}
          {% block extra_body %}{% endblock %}
{% if rooms_count %}
    <!--link rel="stylesheet" href="{% static 'converse.js/converse.min.css' %}" type="text/css" media="screen, projection" -->
    <link rel="stylesheet" href="{% static 'converse.js/css/converse.css' %}" type="text/css" >

    <!--script type="text/javascript" src="{% static 'converse.js/components/jquery/dist/jquery.js' %}"></script-->
    <script type="text/javascript" src="{% static 'converse.js/components/jquery.browser/dist/jquery.browser.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/components/typeahead.js/index.js' %}"></script>

  <!-- BEGIN OTR: Off-the-record encryption stuff. Can be omitted if OTR is not used. -->
    <script type="text/javascript" src="{% static 'converse.js/components/otr/build/dep/salsa20.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/src/bigint.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/components/otr/vendor/cryptojs/core.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/components/otr/vendor/cryptojs/enc-base64.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/components/crypto-js-evanvosberg/src/md5.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/components/crypto-js-evanvosberg/src/evpkdf.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/components/otr/vendor/cryptojs/cipher-core.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/components/otr/vendor/cryptojs/aes.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/components/otr/vendor/cryptojs/sha1.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/components/otr/vendor/cryptojs/sha256.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/components/otr/vendor/cryptojs/hmac.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/components/otr/vendor/cryptojs/pad-nopadding.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/components/otr/vendor/cryptojs/mode-ctr.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/components/otr/build/dep/eventemitter.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/src/otr.js' %}"></script>
    <!-- END OTR -->
 
    <!-- BEGIN STROPHE -->
    <script type="text/javascript" src="{% static 'converse.js/components/strophejs/strophe.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/components/strophejs-plugins/vcard/strophe.vcard.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/components/strophejs-plugins/disco/strophe.disco.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/components/strophejs-plugins/rsm/strophe.rsm.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/src/strophe.ping.js' %}"></script>
    <!-- END STROPHE -->

    <!-- BEGIN BACKBONE -->
    <script type="text/javascript" src="{% static 'converse.js/components/underscore/underscore.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/components/backbone/backbone.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/components/backbone.browserStorage/backbone.browserStorage.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/components/backbone.overview/backbone.overview.js' %}"></script>
    <!-- END BACKBONE -->

    <!-- BEGIN I18N -->
    <!-- These files can be removed if you don't want to include any
        translations for converse.js.
        If you want to modify which translations are included, you can modify
        src/locales.js to remove those you don't need, and then run `make
        build` to generates a new dist/locales.js file.
    -->
    <script type="text/javascript" src="{% static 'converse.js/components/jed/jed.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/locales.js' %}"></script>
    <!-- END I18N -->

    <script type="text/javascript" src="{% static 'converse.js/components/momentjs/min/moment-with-locales.js' %}"></script>
    <script type="text/javascript" src="{% static 'converse.js/converse-no-dependencies.js' %}"></script>
	<style>
		form.add-chatroom { display: none; }
		a.s { display: none; }
	</style>
	{% dmuc_conversejs_initialize %}
	<div id="conversejs"></div>
{% endif %} 
        {% endblock %}
    </body>
</html>
