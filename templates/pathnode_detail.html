{% extends "commons_base.html" %}

{% load i18n %}

{% block head_title %}{{ node.label }} - {% trans "node of path"|capfirst %}: {{ node.path.title }}{% endblock %}

{% block languages %}{% include "_hreflang.html" %}{% endblock %}

{% block body_class %}pathnode_detail{% endblock %}

{% block body %}
 {% if can_edit %}
   {% if not object.original_language %}
   <div style="background: white; border: solid 1px red; font-style: italic; color: red; padding: 6px; margin-top: 30px; margin-bottom: 0.5em;">
   {% trans "IMPORTANT NOTICE! To be able to edit this node, you must first set the editing language of the learning path it belongs to" %}.
   </div>
   {% elif language_mismatch %}
    <div style="background: white; border: solid 1px red; font-style: italic; color: red; padding: 6px; margin-top: 30px; margin-bottom: 0.5em;">
   {% trans "Please note that, to be able to edit this content in its original language" %}
   (<span style="color: black;">{{ object.get_language_name }}</span>)
   {% trans "you should make this the active language using the control in the menu bar" %}.
   </div>
   {% endif %}
 {% endif %}

<article class="panel-white text-left marginTB30">
  <div class="navbar panel-c1 panel-heading-c1 padding1020">
    <h3 class="pull-left marginTB5">{{ node.path }}</h3>
    <p class="pull-right marginB0 font26">
       <a href="/lp/{{ lp.slug }}/play/?node={{i_node}}" title="{% trans "show player view" %}"><i class="fa fa-youtube-play font07em c-white" aria-hidden="true"></i></a>
       <a href="/lp/{{ node.path.slug }}/" title="{% trans "show learning path" %}"><i class="fa fa-list-alt font07em c-white" aria-hidden="true"></i></a>
    </p>
  </div>

  <div class="row" >
    <div class="col-sm-3 col-md-3 col-lg-3">
    {% if nodes %}
      <dl class="panel panel-col font14">
        <dd>
        {% for pathnode in nodes %}
          <ul class="nodes-unlisted {% if pathnode.oer_id %} node-oer {% else %} node-no-oer {% endif %}">
            <li>
            {% if node.id == pathnode.id %} 
              <div>{% if lp.path_type == 2 %}{{ forloop.counter }}. {% endif %}{{ node.label }}</div>
            {% else %}
              {% if lp.path_type == 2 %}{{ forloop.counter }}. {% endif %}<a href="/pathnode/{{ pathnode.id }}/" title="path node">{{ pathnode.label }}</a>
            {% endif %}
            </li>
          </ul>
        {% endfor %}
        </dd>
      </dl>
    {% endif %}
    </div>
    <div class="col-sm-9 col-md-9 col-lg-9">
      <section class="view-node-details">
        <div class="clearfix section-node-header">
          <h3 {% if can_edit %}class="h3-left"{% endif %}>{{ node.label }}
          {% if can_edit and not language_mismatch %}&nbsp; <a href="/pathnode/{{ node.id }}/edit/" title="{% trans "show edit view" %}"><i class="fa fa-edit"></i></a>{% endif %}
          {% if can_translate and object.original_language %}&nbsp; <a href="/datatrans/translate/pathnode/{{ object.pk }}/" title="{% trans "show translate view" %}"><i class="fa fa-language"></i></a>{% endif %}
          </h3>
        </div>
        <div class="section-node-content">
        {% if node.oer %}
          <dl class="font14 marginB10">
            <dt class="demiBold">OER</dt>
          <dd><p>{% if node.oer.state != 3 %}<span style="color: {{ node.oer.get_link_color }};">[{{ node.oer.get_state }}]</span> {% endif %}<span class="font16 demiBold">{{ node.oer }}</span> &nbsp; <a href="/oer/{{ node.oer.slug }}/"><i class="fa fa-list-alt font18 c-pacific-blue" aria-hidden="true"></i></a><br>
            	{{node.oer.description}}</p></dd>
          </dl>
        {% endif %}
        {% if node.range %}
          <dl class="font14 marginB10">
            <dt class="demiBold">{% trans "display range"|capfirst %}</dt>
            <dd>{{ node.range }}</dd>
          </dl>
        {% endif %}
        {% if node.document_id %}
          <dl class="font14 marginB10">
            <dt class="demiBold">{% trans _('document')|capfirst %}</dt>
            <dd>{{ node.document.label }} &nbsp; &nbsp; <a href="/document/{{ node.document_id }}/download/" title="{% trans "download" %}"><i class="fa fa-download"></i></a>
               {% if node.document.viewable %} &nbsp; &nbsp; <a href="/document/{{ node.document_id }}/view/?node=1" title="{% trans "view" %}"><i class="fa fa-eye"></i></a>{% endif %}
            </dd>
          </dl>
        {% endif %}
        {% if node.text %}
          <dl class="font14 marginB10">
            <dt class="demiBold">{% trans _('text')|capfirst %}</dt>
            <dd>{{ node.text|safe }}</dd>
          </dl>
        {% endif %}
        </div>
        <p class="paddingT6"><span class="demiBold">{% trans "node added by"|capfirst %}:</span> <a href="/profile/{{ node.creator.username }}">{{ node.creator.get_full_name }}</a></p>
        {% include "_resource_original_lang.html" %}
      </section>
    </div>
  </div>
</article>
{% endblock %}