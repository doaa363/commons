{% extends "commons_base.html" %}

{% load staticfiles%}
{% load i18n %}
{% load tinymce_tags %}

{% block head_title %}{% if evaluation %}{% trans "edit evaluation of OER"|capfirst %}{% else %}{% trans "add evaluation"|capfirst %}{% endif %} {% trans "of OER" %}:&nbsp; {{ oer.title }}{% endblock %}

{% block extra_head %}
<script type="text/javascript">
//Copyright: CodePug.com 2009
//Do not REMOVE these comments
//Usage: setReadonly('mySelect');
function setReadonly(selectElementId ){
	var selectElement = document.getElementById(selectElementId);
	if (selectElement){		
		var parent = selectElement.parentElement;
		var textValue = selectElement.options[selectElement.options.selectedIndex].textContent;
		if (!parent){
			parent=selectElement.parentNode;
			textValue = selectElement.options[selectElement.options.selectedIndex].text;
		}
		var input = document.createElement("input");
		input.setAttribute("id",selectElement.id);
		input.setAttribute("type","text");
		input.setAttribute("value",textValue);
		input.setAttribute("class","form-control");
		input.style.background="#eeeeee";
		input.readOnly = true;
		parent.appendChild(input);
	}
	selectElement.style.display="none";
}</script>
{% endblock %}

{% block body %}
<div class="container">
  <div class="col-sm-12">
    <section>
       <h2 class="text-center">{% if evaluation %}<span style="font-size:smaller">{% trans "edit evaluation"|capfirst %}{% else %}{% trans "add evaluation"|capfirst %}{% endif %} {% trans "of OER" %}:</span>&nbsp; <i>{{ oer.title }}</i></h2>
    <form method="post" action="{{ action }}" id="oer_evaluation_edit_form" class="form-horizontal">
	{% csrf_token %}
    {% for field in form.hidden_fields %}{{ field }}{% endfor %}
    {% for field in form.visible_fields %}{% with i=forloop.counter %}
    <div class="row"  style="margin-top: 0; margin-bottom: 0;">
	<div class="form-group col-lg-{% if i == 1 %}3{% else %}8{% endif %}">
	    <label for="{{ field.name }}" style="margin-bottom: 0;">{{ field.label|capfirst}} {% if field.required %}<span style="color: red;">*</span>{% endif %}</label>
		<div><span style="color: red;">{{ field.errors }}</span>{{ field }}</div>
		{% if field.help_text %}<span id="{{ field.name }}helpBlock" class="help-block" style="font-size: smaller; margin-bottom: 0;">{{ field.help_text }}</span>{% endif %}
	</div>
	</div>
    {% endwith %}{% endfor %}
	<div class="row" style="margin-top: 0; margin-bottom: 0;"><div class="form-group col-lg-8"><label style="margin-bottom: 0;">{% trans "evaluation  metadata"|capfirst %}</label></div></div>
	<table style="border-collapse: separate; border-spacing: 1.5em 0.1em;">
    {% for fm in metadata_formset %}
    {% if forloop.first %}<thead><tr style="margin: 0;">{% for field in fm.visible_fields %}<td>{{ field.label|capfirst}}</th>{% endfor %}</td></thead><tbody>{% endif %}  
    <tr>{% for field in fm.hidden_fields %}{{ field }}{% endfor %}
    	{% for field in fm.visible_fields %}<td><span style="color: red;">{{ field.errors }}</span>{{ field }}</td>{% endfor %}</tr>
    {% endfor %}
   	</tbody></table>
    {{ metadata_formset.management_form }}
   	</div></div>
		<button type="submit" name="save" id="save" value="save" class="btn btn-default" style="margin-top: 0.5em; margin-left: 0;">Save{% if evaluation %} changes{% endif %}</button>&nbsp;
		<button type="submit" name="continue" id="continue" value="continue" class="btn btn-default" style="margin-top: 0.5em; margin-left: 0;">Save and continue</button>&nbsp;
		<button type="submit" name="cancel" id="cancel" value="cancel" class="btn btn-default" style="margin-top: 0.5em; margin-left: 0;">Cancel (user view)</button>
    </form>
    </section>
  </div>
{% endblock %}

{% block extra_script %}
{% if evaluation %}
<script type="text/javascript">
	setReadonly('id_oer');
</script>
{% endif %}
{% endblock %}
