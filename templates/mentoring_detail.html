{% extends "commons_base.html" %}

{% load i18n %}

{% block head_title %}{% if proj_type.name = 'com' %}{% trans "community"|capfirst %}{% else %}{% trans "project"|capfirst %}{% endif %}: {{ project.get_name }}{% endblock %}

{% block languages %}{% include "_hreflang.html" %}{% endblock %}

{% block extra_head %}
<style>
    form label  { display: inline; }
    ul#id_mentor { list-style-type: none; }
    ul#id_mentor li label { font-weight: normal;  font-size: 12px; }
</style>
{% endblock %}

{% block body_class %}mentoring_detail{% endblock %}
{% block body %}
<div class="marginT30 marginB20" style="background:#EBEDED; border-bottom: 6px solid #67AE73; border-bottom-left-radius: 6px; border-bottom-right-radius: 6px;">
  <div class="bc-c0 c-white" style="padding:10px 20px 0 20px; border-top-left-radius:6px; border-top-right-radius:6px">
    <ul class="list-inline marginB0">
      {% with users=project.members %}
      {% for u in users %}
        <li class="marginB10">
          {% if u.0.get_profile.avatar %}
            <img src="/media/{{  u.0.get_profile.avatar }}" class="avatar-medium">
          {% else %}
            <img src="/media/images/avatars/anonymous.png" class="avatar-medium">
          {% endif %}
            <a href="/profile/{{ u.0.username }}/" title="{% trans "view user profile" %}" class="btn btn-default font12">{{ u.0.get_display_name }}<br><i>{% if u.1 %}{{ project.admin_name }}{% else %}{% trans "mentee" %}{% endif %}</i></a>
        </li>
      {% endfor %}
      {% if users|length == 1 %}
         <li class="marginB10 c-white font12"><img src="/media/images/avatars/question.png" class="avatar-medium"> &nbsp;<i>{% trans "mentor" %}</i></li>
      {% endif %}
      {% endwith %}
      <li class="marginB10"><h1 class="font-small c-white" style="margin:0">{{ project.get_name }}</h1></li>
    </ul>
  </div>
  <p style="background:white; padding:6px 15px">
   {% if is_closed %}
     <span class="neutral"><i class="fa fa-lock" aria-hidden="true"></i> </span>
   {% endif %}	
   {% if is_draft %}
     <span class="orange"><i class="fa fa-user" aria-hidden="true"></i><i class="fa fa-arrows-h" aria-hidden="true"></i><i class="fa fa-user" aria-hidden="true"></i> </span>
   {% elif is_submitted %}
     <span class="limegreen"><i class="fa fa-user" aria-hidden="true"></i><i class="fa fa-arrows-h" aria-hidden="true"></i><i class="fa fa-user" aria-hidden="true"></i> </span>
   {% elif is_open or is_closed %}
      <span class="neutral"><i class="fa fa-user" aria-hidden="true"></i><i class="fa fa-arrows-h" aria-hidden="true"></i><i class="fa fa-user" aria-hidden="true"></i> </span>
   {% elif is_deleted %}
     <span class="red"><i class="fa fa-user" aria-hidden="true"></i><i class="fa fa-arrows-h" aria-hidden="true"></i><i class="fa fa-user" aria-hidden="true"></i> </span>
   {% endif %}
   {{ proj_type.description }}
   {% with parent=project.get_parent %}
     &nbsp; - &nbsp;{% trans "community"|capfirst %}: <a href="/project/{{ parent.slug }}/">{{ parent.get_name }}</a>
   {% endwith %}
  </p>
  <div class="row marginLR0 paddingT10">
    <div class="{% if is_open or is_closed %}col-sm-7 col-md-7 col-lg-8{% else %}col-sm-12 col-md-12 col-lg-12{% endif %}">
     <article class="view-list">
       <p class="font16"><i>{{ project.description }}</i></p>
       {% if project.info %}
         <dl class="list-inline font14 clearfix">
            <dt>{% trans "additional information"|capfirst %}</dt>
            <dd class="field-content width-full"><blockquote class="font14">{{ project.info|safe }}</blockquote></dd>
         </dl>
       {% endif %}
     </article>
     {% if can_edit or can_open or can_close or is_admin or can_propose or view_shared_folder %}
       <ul class="list-inline marginLB020">
         <li class="list-back-c0">
           <ul class="list-inline">
             {% if can_edit and not is_closed %}<li class="marginB5"><a href="/project/{{ project.slug }}/edit/" title="{% trans "show edit view" %}" class="btn btn-default"><i class="fa fa-edit"></i> {% trans "modify" %}</a></li>{% endif %}
             {% if can_propose %}<li class="marginB5"><a href="/project/{{ project.id }}/propose/" title="{% trans "submit request" %}" class="btn btn-default"><i class="fa fa-mail-forward"></i> {% trans "submit request" %}</a></li>{% endif %}
             {% if can_open and is_admin %}<li class="marginB5"><a href="/project/{{ project.id }}/open/" title="{% trans "open" %}" class="btn btn-default"><i class="fa fa-unlock"></i> {% trans "open" %}</a></li>{% endif %}
             {% if can_close and is_admin %}<li class="marginB5"><a href="/project/{{ project.id }}/close/" title="{% trans "close" %}" class="btn btn-default"><i class="fa fa-lock"></i> {% trans "close" %}</a></li>{% endif %}
           </ul>
         </li>
         {% if view_shared_folder %}
           <li class="list-back-black"><ul class="list-inline"><li class="marginB5"><a href="/project/{{ project.slug }}/folder/" class="btn btn-default"><i class="fa fa-folder-open-o"></i> {% trans "view the shared folder" %}</a></li></ul></li>
         {% endif %}
         {% if is_admin and is_open and project.need_create_room %}
           <li class="list-back-black"><ul class="list-inline"><li class="marginB5"><a href="/project/{{ project.id }}/create_room/" class="btn btn-default"><i class="fa fa-comments-o"></i> {% trans "enable chatroom" %}</a></li></ul></li> 
         {% endif %}
       </ul>
     {% endif %}

     {% if is_parent_admin and is_submitted and not mentor and candidate_mentors %}
       <div class="panel-white">
         <h5 class="bc-c0 c-white padding510 margin0" style="border-top-left-radius:3px; border-top-right-radius:3px;">{% trans "candidate mentors"|capfirst %}</h5>
         <form method="post" action="/set_mentor/" class="padding510">{% csrf_token %}
             {% for hidden in match_mentor_form.hidden_fields %}{{ hidden }}{% endfor %}
             <div class="form-group">
             {% for field in match_mentor_form.visible_fields %}
             {{ field.label_tag }} {{ field }}
             {% endfor %}
             </div>
             <div class="form-group"><input type="submit" class="btn btn-default" value="{% trans "assign mentee to selected mentor"|capfirst %}" id="match_mentor"></div>
           </form>
       </div>
     {% endif %}
     {% if can_send_message %}
       <div class="panel-white">
         <ul class="nav nav-tabs" style="background:#ebeded; border-top-left-radius:4px; border-top-right-radius:4px;">
           <li class="active"><a data-toggle="tab" href="#inbox">{% trans "received messages"|capfirst %}</a></li>
           <li><a data-toggle="tab" href="#outbox">{% trans "sent messages"|capfirst %}</a></li>
           <li><a data-toggle="tab" href="#compose">{% trans "new message"|capfirst %}</a></li>
         </ul>
         <div class="tab-content padding510">
           <div id="inbox" class="tab-pane fade in active">
             {% if inbox %}
               <ul class="list-unstyled my-list-unstyled padding510">
                {% for msg in inbox %}
                  <li><small><a href="/my_mail/view/{{ msg.id }}/">{{ msg.subject }}</a> &nbsp; &nbsp; [{{ msg.sent_at }}]</small></li>
                {% endfor %}
               </ul>
             {% else %}
               <p><small>{% trans "no messages received"|capfirst %}</small></p>
             {% endif %}
           </div>
           <div id="outbox" class="tab-pane fade">
             {% if outbox %}
               <ul class="list-unstyled my-list-unstyled padding510">
                 {% for msg in outbox %}
                   <li><small><a href="/my_mail/view/{{ msg.id }}/">{{ msg.subject }}</a> &nbsp; &nbsp; [{{ msg.sent_at }}]</small></li>
                 {% endfor %}
               </ul>
             {% else %}
               <p><small>{% trans "no messages sent"|capfirst %}</small></p>
             {% endif %}
           </div>
           <div id="compose" class="tab-pane fade">
             <form method="post" action="#" class="padding510">{% csrf_token %}
               {% for hidden in compose_message_form.hidden_fields %}{{ hidden }}{% endfor %}
               {% for field in compose_message_form.visible_fields %}
                 <div class="form-group">
                   <label for="{{ field.name }}" {% if field.field.required %}class="required"{% endif %}>{{ field.label|capfirst}}</label>
                     <span class="txt-error">{{ field.errors }}</span>{{ field }}
                 </div>
               {% endfor %}
               <div class="form-group"><input type="submit" class="btn btn-default" name="send" value="{% trans "send" %}"></div>
             </form>
           </div>
         </div>
       </div>
     {% endif %}
   </div>
 
   {% if is_open or is_closed %}
   <div class="col-sm-5 col-md-5 col-lg-4">
   	       {% if can_add_oer or can_add_lp %}
          <div>
            <ul class="list-inline padding10510">
            {% if can_add_oer %}
                <li class="list-back-c2 marginB5">
                   <ul class="list-inline">
                      <li><div class="c-white marginB5 demiBold">{% trans "OER" %}</div>
                         <ul class="list-inline list-last">
                            <li class="marginB5"><a href="/project/{{ project.id }}/oer_new/" class="btn btn-default"><i class="fa fa-file-text-o"></i> {% trans "classify"|capfirst %}</a></li>
{% comment %}
                            {% if cut_oers %}{% for oer in cut_oers %}
                              <li class="marginB5"><a href="/project/{{ project.id }}/paste_oer/{{ oer.id }}/" class="btn btn-default" title="{{ oer.title }}"><i class="fa fa-clipboard"></i> {% trans "paste"|capfirst %} "{{ oer.title|truncatewords:5 }}"</a></li>
                            {% endfor %}{% endif %}
{% endcomment %}
                            {% if shareable_oers %}{% for oer in shareable_oers %}
                              <li class="marginB5"><a href="/project/{{ project.id }}/add_shared_oer/{{ oer.id }}/" class="btn btn-default" title="{{ oer.title }}"><i class="fa fa-share-alt"></i> {% trans "share"|capfirst %} "{{ oer.title|truncatewords:5 }}"</a></li>
                            {% endfor %}{% endif %}
                         </ul>
                      </li>
                   </ul>
                </li>
              {% endif %}
              {% if can_add_lp %}
                <li class="list-back-c1 marginB5">
                   <ul class="list-inline">
                      <li><div class="c-white marginB5 demiBold">{% trans "LP" %}</div>
                         <ul class="list-inline list-last">
                            <li class="marginB5"><a href="/project/{{ project.id }}/lp_new/" class="btn btn-default"><i class="fa fa-file-o"></i> {% trans "create"|capfirst %}</a></li>
{% comment %}
                            {% if cut_lps %}{% for lp in cut_lps %}
                              <li class="marginB5"><a href="/project/{{ project.id }}/paste_lp/{{ lp.id }}/" class="btn btn-default"  title="{{ lp.title }}"><i class="fa fa-clipboard"></i> {% trans "paste"|capfirst %} "{{ lp.title|truncatewords:5 }}"</a></li>
                            {% endfor %}{% endif %}
{% endcomment %}
                            {% if shareable_lps %}{% for lp in shareable_lps %}
                              <li class="marginB5"><a href="/project/{{ project.id }}/add_shared_lp/{{ lp.id }}/" class="btn btn-default" title="{{ lp.title }}"><i class="fa fa-share-alt"></i> {% trans "share"|capfirst %} "{{ lp.title|truncatewords:5 }}"</a></li>
                            {% endfor %}{% endif %}
                         </ul>
                      </li>
                   </ul>
                </li>
              {% endif %}
            </ul>
            </div>
            {% endif %}
            

         {% if lps %}
           <div class="panel-white">
             <div class="panel-heading-c1 padding510 demiBold">{% trans "last learning paths"|capfirst %}</div>
             <ul class="list-unstyled my-list-unstyled padding510">
             {% for lp in lps %}
               <li>{% if lp.state != 3 %}<small style="color: {{ lp.get_link_color }};">[{{ lp.get_state }}]</small> {% endif %}<a href="/lp/{{ lp.slug }}/"><small>{{ lp.title }}</small></a></li>
             {% endfor %}
             </ul>
             {% if n_lps > lps|length %}
               <div class="panel-footer-c1 padding510 text-center demiBold"><a href="/project/{{ project.slug }}/project_results/#p_lps">{% trans "read more"|upper %}</a></div>
             {% endif %}
           </div>
         {% endif %}
         {% if shared_lps %}
           <div class="panel-white">
             <div class="panel-heading-c1 padding510 demiBold">{% trans "shared LPs"|capfirst %}</div>
             <ul class="list-unstyled my-list-unstyled padding510">
             {% for shared_lp, deletable in shared_lps %}
               <li>{% if deletable %}<a class="deleteNode" href="/shared_lp_delete/{{ shared_lp.id }}/" title="{% trans "unshare this LP" %}"><i class="fa fa-times-circle red"></i></a>{% endif %}
                   <a href="/lp/{{ shared_lp.lp.slug }}/">{{ shared_lp.lp.title }}</a>
               </li>
             {% endfor %}
             </ul>
           </div>
         {% endif %}
         {% if oers %}
           <div class="panel-white">
             <div class="panel-heading-c2 padding510 demiBold">{% trans "last OERs"|capfirst %}</div>
             <ul class="list-unstyled my-list-unstyled padding510">
             {% for oer in oers %}
               <li>{% if oer.state != 3 %}<small style="color: {{ oer.get_link_color }};">[{{ oer.get_state }}]</small> {% endif %}<a href="/oer/{{ oer.slug }}/"><small>{{ oer.title }}</small></a> </li>
             {% endfor %}
             </ul>
             {% if n_oers > oers.count %}
               <div class="panel-footer-c2 padding510 text-center demiBold"><a href="/project/{{ project.slug }}/project_results/#p_oers">{% trans "read more"|upper %}</a></div>
             {% endif %}
           </div>
         {% endif %}
         {% if shared_oers %}
           <div class="panel-white">
             <div class="panel-heading-c2 padding510 demiBold">{% trans "shared OERs"|capfirst %}</div>
             <ul class="list-unstyled my-list-unstyled padding510">
             {% for shared_oer, deletable in shared_oers %}
               <li>{% if deletable %}<a class="deleteNode"  href="/shared_oer_delete/{{ shared_oer.id }}/" title="{% trans "unshare this OER" %}"><i class="fa fa-times-circle red"></i></a>{% endif %}
                   <a href="/oer/{{ shared_oer.oer.slug }}/">{{ shared_oer.oer.title }}</a>
               </li>
             {% endfor %}
             </ul>
           </div>
         {% endif %}

   </div>
   {% endif %}
  </div>
</div>
{% endblock %}
